using GameServer.Packets;
using RSLIB;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GameServer
{
    public class NPCInfoRequestPacket :IPacketHandler
    {
        private byte[] _packet;
        private Client client;

        public void Run()
        {
            
            List<byte> avatarData = new List<byte>();

            byte.TryParse(this.client.avatar["job"].ToString(), out byte jobByte);



            byte[] first_job = Skill.GetSkillsBytesByJob(jobByte);

            byte[] second_job = Skill.GetSkillsBytesByJob(Job.GetTransformJob(jobByte));

            Log.Debug($"1 JOB: {jobByte}");
            Log.Packet(second_job);


            avatarData.AddRange(Convert.FromHexString("90 08 3D 12 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 EC 13 00 00 B8 0B 00 00 00 00 00 00 00 00 00 00 64 00 64 00 19 00 0F 00 14 00 0A 00 05 00 0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 FF FF 00 00 FF FF 00 00 FF FF 00 00 00 00 00 00 74 65 6D 70 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00".Replace(" ", "")));

            avatarData.AddRange(Helper.DefineLengthAndInsertString((string)client.avatar["avatar_name"], 18));
            avatarData.Add(jobByte);

            avatarData.AddRange(Convert.FromHexString("00 00 00 00 00 00 00 00 00 00 00 B8 0B 00 00 B8 0B 00 00 00 00 00 00 00 00 00 00 00 00".Replace(" ", String.Empty)));

            avatarData.AddRange(first_job);
            avatarData.AddRange(second_job);
            avatarData.AddRange(new byte[] { 0xFF, 0xFF, 0x00, 0x00, 0xFF, 0xFF });
            avatarData.AddRange(new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 });


            this.client.socket.Send(avatarData.ToArray());

        }

        public void SetPacketAndClient(byte[] packet, Client client)
        {
            this._packet = packet;
            this.client = client;
        }
    }
}


